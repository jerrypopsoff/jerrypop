name: Execute TypeScript type check

on:
  pull_request:
    types: [opened, synchronize, reopened]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  type-check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Setup dependencies
        uses: ./.github/actions/setup-dependencies
      # Create `next-env.d.ts` file, which is required for TypeScript to
      # recognize Next.js types. This file is generated by `next build`, but
      # adding that as a step would be overkill for a type check.
      # https://github.com/t3-oss/create-t3-turbo/issues/472#issuecomment-2744067498
      - name: Create `next-env.d.ts` file
        run: echo -e '/// <reference types="next" />\n/// <reference types="next/image-types/global" />' > src/next-env.d.ts
      - name: Execute TypeScript type check
        run: pnpm type-check
